## API Report File for "@candidstartup/infinisheet-types"

> Do not edit this file. It is a report generated by [API Extractor](https://api-extractor.com/).

```ts

import { Err as Err_2 } from 'neverthrow';
import { Ok as Ok_2 } from 'neverthrow';
import { ResultAsync as ResultAsync_2 } from 'neverthrow';

// @public
export type AddEntryError = ConflictError | StorageError;

// @public
export interface BlobDir<ContinuationT> {
    getDir(name: BlobName): ResultAsync<BlobDir<ContinuationT>, GetDirError>;
    query(continuation?: ContinuationT): ResultAsync<BlobDirEntries<ContinuationT>, DirQueryError>;
    readBlob(name: BlobName): ResultAsync<Uint8Array, ReadBlobError>;
    removeAll(): ResultAsync<void, RemoveAllBlobDirError>;
    removeBlob(name: BlobName): ResultAsync<void, RemoveBlobError>;
    writeBlob(name: BlobName, content: Uint8Array): ResultAsync<void, WriteBlobError>;
}

// @public (undocumented)
export interface BlobDirEntries<ContinuationT> {
    blobs: BlobName[];
    continuation?: ContinuationT | undefined;
    dirs: BlobName[];
}

// @public
export type BlobId = string;

// @public
export type BlobName = string;

// @public
export interface BlobStore<ContinuationT> {
    getRootDir(): ResultAsync<BlobDir<ContinuationT>, GetRootDirError>;
}

// @public
export interface BlobWrongKindError extends InfinisheetError {
    type: 'BlobWrongKindError';
}

// @public
export interface CellData {
    format?: CellFormat;
    value: CellValue;
}

// @public
export interface CellError {
    type: 'CellError';
    value: CellErrorValue;
}

// @public
export type CellErrorValue = '#NULL!' | '#DIV/0!' | '#VALUE!' | '#REF!' | '#NAME?' | '#NUM!' | '#N/A' | '#GETTING_DATA' | '#SPILL!' | '#UNKNOWN!' | '#FIELD!' | '#CALC!';

// @public
export type CellFormat = string | undefined;

// @public
export type CellValue = string | number | boolean | null | undefined | CellError;

// @public
export type ColRef = string;

// @public
export function colRefToIndex(col: ColRef): number;

// @public
export interface ConflictError extends InfinisheetError {
    nextSequenceId: SequenceId;
    type: 'ConflictError';
}

// @public
export function conflictError(message: string, nextSequenceId: SequenceId): ConflictError;

// @public
export type DirQueryError = StorageError | NoContinuationError;

// @public (undocumented)
export class EmptySpreadsheetData implements SpreadsheetData<number> {
    // (undocumented)
    getCellFormat(_snapshot: number, _row: number, _column: number): string | undefined;
    // (undocumented)
    getCellValue(_snapshot: number, _row: number, _column: number): CellValue;
    // (undocumented)
    getColumnCount(_snapshot: number): number;
    // (undocumented)
    getColumnItemOffsetMapping(_snapshot: number): ItemOffsetMapping;
    // (undocumented)
    getLoadStatus(_snapshot: number): Result<boolean, StorageError>;
    // (undocumented)
    getRowCount(_snapshot: number): number;
    // (undocumented)
    getRowItemOffsetMapping(_snapshot: number): ItemOffsetMapping;
    // (undocumented)
    getSnapshot(): number;
    // (undocumented)
    isValidCellValueAndFormat(_row: number, _column: number, _value: CellValue, _format: CellFormat): Result<void, ValidationError>;
    // (undocumented)
    setCellValueAndFormat(_row: number, _column: number, _value: CellValue, _format: CellFormat): ResultAsync<void, SpreadsheetDataError>;
    // (undocumented)
    subscribe(_onDataChange: () => void): () => void;
}

// @public
export interface Err<T, E> extends Err_2<T, E> {
}

// @public
export function err<T = never, E extends string = string>(err: E): Err<T, E>;

// @public (undocumented)
export function err<T = never, E = unknown>(err: E): Err<T, E>;

// @public (undocumented)
export function err<T = never, _E extends void = void>(err: void): Err<T, void>;

// @public
export function errAsync<T = never, E = unknown>(err: E): ResultAsync<T, E>;

// @public (undocumented)
export function errAsync<T = never, _E extends void = void>(err: void): ResultAsync<T, void>;

// @public
export interface EventLog<T extends LogEntry> {
    addEntry(entry: T, sequenceId: SequenceId): ResultAsync<void, AddEntryError>;
    query(start: SequenceId | 'snapshot' | 'start', end: SequenceId | 'end'): ResultAsync<QueryValue<T>, QueryError>;
    setMetadata(sequenceId: SequenceId, metaData: LogMetadata): ResultAsync<void, MetadataError>;
    truncate(start: SequenceId): ResultAsync<void, TruncateError>;
}

// @public
export class FixedSizeItemOffsetMapping implements ItemOffsetMapping {
    constructor(itemSize: number);
    // (undocumented)
    itemOffset(itemIndex: number): number;
    // (undocumented)
    itemSize(_itemIndex: number): number;
    // (undocumented)
    offsetToItem(offset: number): [itemIndex: number, startOffset: number];
}

// @public
export type GetDirError = BlobWrongKindError | InvalidBlobNameError | StorageError;

// @public
export type GetRootDirError = StorageError;

// @public
export function indexToColRef(index: number): ColRef;

// @public
export interface InfinisheetError {
    message: string;
    type: string;
}

// @public
export interface InfinisheetRangeError extends InfinisheetError {
    type: 'InfinisheetRangeError';
}

// @public
export function infinisheetRangeError(message: string): InfinisheetRangeError;

// @public (undocumented)
export interface InfiniSheetWorker<MessageT extends WorkerMessage> {
    // (undocumented)
    onReceiveMessage: MessageHandler<MessageT> | undefined;
}

// @public
export interface InvalidBlobNameError extends InfinisheetError {
    type: 'InvalidBlobNameError';
}

// @public (undocumented)
export function invalidBlobNameError(message?: string): InvalidBlobNameError;

// @public
export interface ItemOffsetMapping {
    itemOffset(itemIndex: number): number;
    itemSize(itemIndex: number): number;
    offsetToItem(offset: number): [itemIndex: number, startOffset: number];
}

// @public
export interface LogEntry extends LogMetadata {
    type: string;
}

// @public
export interface LogMetadata {
    history?: BlobId | undefined;
    pending?: WorkflowId | undefined;
    snapshot?: BlobId | undefined;
}

// @public
export type MessageHandler<MessageT extends WorkerMessage> = (message: MessageT) => void;

// @public
export type MetadataError = InfinisheetRangeError | StorageError;

// @public
export interface NoContinuationError extends InfinisheetError {
    type: 'NoContinuationError';
}

// @public (undocumented)
export function noContinuationError(message?: string): NoContinuationError;

// @public (undocumented)
export function notBlobDirError(): BlobWrongKindError;

// @public (undocumented)
export function notBlobError(): BlobWrongKindError;

// @public
export interface Ok<T, E> extends Ok_2<T, E> {
}

// @public
export function ok<T, E = never>(value: T): Ok<T, E>;

// @public (undocumented)
export function ok<_T extends void = void, E = never>(value: void): Ok<void, E>;

// @public
export function okAsync<T, E = never>(value: T): ResultAsync<T, E>;

// @public (undocumented)
export function okAsync<_T extends void = void, E = never>(value: void): ResultAsync<void, E>;

// @public (undocumented)
export interface PendingWorkflowMessage {
    sequenceId: SequenceId;
    // (undocumented)
    type: "PendingWorkflowMessage";
    workflow: WorkflowId;
}

// @public (undocumented)
export interface PostMessageWorkerHost<MessageT extends WorkerMessage> extends WorkerHost<MessageT> {
    // (undocumented)
    postMessage(message: MessageT): void;
}

// @public
export type QueryError = InfinisheetRangeError | StorageError;

// @public
export interface QueryValue<T extends LogEntry> {
    endSequenceId: SequenceId;
    entries: T[];
    isComplete: boolean;
    startSequenceId: SequenceId;
}

// @public
export type ReadBlobError = BlobWrongKindError | InvalidBlobNameError | StorageError;

// @public
export type RemoveAllBlobDirError = StorageError;

// @public
export type RemoveBlobError = BlobWrongKindError | InvalidBlobNameError | StorageError;

// @public
export type Result<T, E> = Ok<T, E> | Err<T, E>;

// @public
export class ResultAsync<T, E> extends ResultAsync_2<T, E> {
}

// @public
export type RowColCoords = [row: number | undefined, col: number | undefined];

// @public
export function rowColCoordsToRef(row: number | undefined, col: number | undefined): RowColRef;

// @public
export type RowColRef = string;

// @public
export function rowColRefToCoords(ref: RowColRef): RowColCoords;

// @public
export type SequenceId = bigint;

// @public
export function splitRowColRef(ref: RowColRef): [row: number | undefined, col: ColRef | undefined];

// @public
export interface SpreadsheetData<Snapshot> {
    getCellFormat(snapshot: Snapshot, row: number, column: number): CellFormat;
    getCellValue(snapshot: Snapshot, row: number, column: number): CellValue;
    getColumnCount(snapshot: Snapshot): number;
    getColumnItemOffsetMapping(snapshot: Snapshot): ItemOffsetMapping;
    getLoadStatus(snapshot: Snapshot): Result<boolean, StorageError>;
    getRowCount(snapshot: Snapshot): number;
    getRowItemOffsetMapping(snapshot: Snapshot): ItemOffsetMapping;
    getSnapshot(): Snapshot;
    isValidCellValueAndFormat(row: number, column: number, value: CellValue, format: CellFormat): Result<void, ValidationError>;
    setCellValueAndFormat(row: number, column: number, value: CellValue, format: CellFormat): ResultAsync<void, SpreadsheetDataError>;
    subscribe(onDataChange: () => void): () => void;
}

// @public
export type SpreadsheetDataError = ValidationError | StorageError;

// @public
export interface StorageError extends InfinisheetError {
    statusCode?: number | undefined;
    type: 'StorageError';
}

// @public
export function storageError(message: string, statusCode?: number): StorageError;

// @public
export type TruncateError = InfinisheetRangeError | StorageError;

// @public
export interface ValidationError extends InfinisheetError {
    type: 'ValidationError';
}

// @public
export function validationError(message: string): ValidationError;

// @public
export class VariableSizeItemOffsetMapping implements ItemOffsetMapping {
    constructor(defaultItemSize: number, sizes: number[]);
    // (undocumented)
    itemOffset(itemIndex: number): number;
    // (undocumented)
    itemSize(itemIndex: number): number;
    // (undocumented)
    offsetToItem(offset: number): [itemIndex: number, startOffset: number];
}

// @public (undocumented)
export interface WorkerHost<MessageT extends WorkerMessage> {
    // @internal
    isHost(): this is WorkerHost<MessageT>;
}

// @public (undocumented)
export interface WorkerMessage {
    type: string;
}

// @public
export type WorkflowId = string;

// @public
export type WriteBlobError = BlobWrongKindError | InvalidBlobNameError | StorageError;

// (No @packageDocumentation comment for this package)

```
