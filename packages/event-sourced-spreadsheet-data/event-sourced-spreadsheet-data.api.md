## API Report File for "@candidstartup/event-sourced-spreadsheet-data"

> Do not edit this file. It is a report generated by [API Extractor](https://api-extractor.com/).

```ts

import { BlobDir } from '@candidstartup/infinisheet-types';
import { BlobId } from '@candidstartup/infinisheet-types';
import { BlobStore } from '@candidstartup/infinisheet-types';
import { CellData } from '@candidstartup/infinisheet-types';
import { CellFormat } from '@candidstartup/infinisheet-types';
import { CellRangeCoords } from '@candidstartup/infinisheet-types';
import { CellValue } from '@candidstartup/infinisheet-types';
import { EventLog } from '@candidstartup/infinisheet-types';
import { InfiniSheetWorker } from '@candidstartup/infinisheet-types';
import { ItemOffsetMapping } from '@candidstartup/infinisheet-types';
import { LogEntry } from '@candidstartup/infinisheet-types';
import { PendingWorkflowMessage } from '@candidstartup/infinisheet-types';
import { Result } from '@candidstartup/infinisheet-types';
import { ResultAsync } from '@candidstartup/infinisheet-types';
import { SequenceId } from '@candidstartup/infinisheet-types';
import { SpreadsheetData } from '@candidstartup/infinisheet-types';
import { SpreadsheetDataError } from '@candidstartup/infinisheet-types';
import { SpreadsheetViewport } from '@candidstartup/infinisheet-types';
import { StorageError } from '@candidstartup/infinisheet-types';
import { ValidationError } from '@candidstartup/infinisheet-types';
import { WorkerHost } from '@candidstartup/infinisheet-types';

// Warning: (ae-internal-missing-underscore) The name "CellMapEntry" should be prefixed with an underscore because the declaration is marked as @internal
//
// @internal
export interface CellMapEntry extends CellData {
    logIndex?: number | undefined;
}

// Warning: (ae-internal-missing-underscore) The name "CellMapExtents" should be prefixed with an underscore because the declaration is marked as @internal
//
// @internal (undocumented)
export interface CellMapExtents {
    // (undocumented)
    columnMax: number;
    // (undocumented)
    columnMin: number;
    // (undocumented)
    rowMax: number;
    // (undocumented)
    rowMin: number;
}

// @public
export interface EventSourcedSnapshot {
    // @internal (undocumented)
    _brand: _EventSourcedSnapshotBrand;
}

// @internal
export enum _EventSourcedSnapshotBrand {
    // (undocumented)
    _DO_NOT_USE = ""
}

// Warning: (ae-internal-missing-underscore) The name "EventSourcedSnapshotContent" should be prefixed with an underscore because the declaration is marked as @internal
//
// @internal (undocumented)
export interface EventSourcedSnapshotContent {
    // (undocumented)
    colCount: number;
    // (undocumented)
    endSequenceId: SequenceId;
    // (undocumented)
    logLoadStatus: Result<boolean, StorageError>;
    // (undocumented)
    logSegment: LogSegment;
    // (undocumented)
    mapLoadStatus: Result<boolean, StorageError>;
    // (undocumented)
    rowCount: number;
    // (undocumented)
    viewport: SpreadsheetViewport | undefined;
    // (undocumented)
    viewportCellRange: CellRangeCoords | undefined | null;
}

// Warning: (ae-incompatible-release-tags) The symbol "EventSourcedSpreadsheetData" is marked as @public, but its signature references "EventSourcedSpreadsheetEngine" which is marked as @internal
//
// @public
export class EventSourcedSpreadsheetData extends EventSourcedSpreadsheetEngine implements SpreadsheetData<EventSourcedSnapshot> {
    constructor(eventLog: EventLog<SpreadsheetLogEntry>, blobStore: BlobStore<unknown>, workerHost?: WorkerHost<PendingWorkflowMessage>, options?: EventSourcedSpreadsheetDataOptions);
    // (undocumented)
    getCellFormat(snapshot: EventSourcedSnapshot, row: number, column: number): CellFormat;
    // (undocumented)
    getCellValue(snapshot: EventSourcedSnapshot, row: number, column: number): CellValue;
    // (undocumented)
    getColumnCount(snapshot: EventSourcedSnapshot): number;
    // (undocumented)
    getColumnItemOffsetMapping(_snapshot: EventSourcedSnapshot): ItemOffsetMapping;
    // (undocumented)
    getLoadStatus(snapshot: EventSourcedSnapshot): Result<boolean, StorageError>;
    // (undocumented)
    getRowCount(snapshot: EventSourcedSnapshot): number;
    // (undocumented)
    getRowItemOffsetMapping(_snapshot: EventSourcedSnapshot): ItemOffsetMapping;
    // (undocumented)
    getSnapshot(): EventSourcedSnapshot;
    // (undocumented)
    getViewport(snapshot: EventSourcedSnapshot): SpreadsheetViewport | undefined;
    // (undocumented)
    isValidCellValueAndFormat(_row: number, _column: number, _value: CellValue, _format: CellFormat): Result<void, ValidationError>;
    // (undocumented)
    protected notifyListeners(): void;
    // (undocumented)
    setCellValueAndFormat(row: number, column: number, value: CellValue, format: CellFormat): ResultAsync<void, SpreadsheetDataError>;
    // (undocumented)
    setViewport(viewport: SpreadsheetViewport | undefined): void;
    // (undocumented)
    subscribe(onDataChange: () => void): () => void;
    // (undocumented)
    protected workerHost?: WorkerHost<PendingWorkflowMessage> | undefined;
}

// @public
export interface EventSourcedSpreadsheetDataOptions {
    restartPendingWorkflowsOnLoad?: boolean | undefined;
    snapshotInterval?: number | undefined;
    viewportEmpty?: boolean | undefined;
}

// Warning: (ae-internal-missing-underscore) The name "EventSourcedSpreadsheetEngine" should be prefixed with an underscore because the declaration is marked as @internal
//
// @internal
export abstract class EventSourcedSpreadsheetEngine {
    constructor(eventLog: EventLog<SpreadsheetLogEntry>, blobStore: BlobStore<unknown>, viewportCellRange?: CellRangeCoords | null, viewport?: SpreadsheetViewport);
    // (undocumented)
    protected blobStore: BlobStore<unknown>;
    // (undocumented)
    protected content: EventSourcedSnapshotContent;
    // (undocumented)
    protected eventLog: EventLog<SpreadsheetLogEntry>;
    // (undocumented)
    protected isInSyncLogs: boolean;
    // (undocumented)
    protected abstract notifyListeners(): void;
    // (undocumented)
    protected setViewportCellRange(viewportCellRange: CellRangeCoords | null | undefined, viewport?: SpreadsheetViewport): void;
    // (undocumented)
    protected syncLogsAsync(endSequenceId?: SequenceId): Promise<void>;
}

// Warning: (ae-incompatible-release-tags) The symbol "EventSourcedSpreadsheetWorkflow" is marked as @public, but its signature references "EventSourcedSpreadsheetEngine" which is marked as @internal
//
// @public
export class EventSourcedSpreadsheetWorkflow extends EventSourcedSpreadsheetEngine {
    constructor(eventLog: EventLog<SpreadsheetLogEntry>, blobStore: BlobStore<unknown>, worker: InfiniSheetWorker<PendingWorkflowMessage>);
    // (undocumented)
    protected notifyListeners(): void;
    // (undocumented)
    protected worker: InfiniSheetWorker<PendingWorkflowMessage>;
}

// Warning: (ae-internal-missing-underscore) The name "GridTileFormat" should be prefixed with an underscore because the declaration is marked as @internal
//
// @internal
export interface GridTileFormat extends TileFormat {
    // (undocumented)
    tileHeight: number;
    // (undocumented)
    tileWidth: number;
    // (undocumented)
    type: "grid";
}

// Warning: (ae-internal-missing-underscore) The name "LogSegment" should be prefixed with an underscore because the declaration is marked as @internal
//
// @internal (undocumented)
export interface LogSegment {
    // (undocumented)
    cellMap: SpreadsheetCellMap;
    // (undocumented)
    entries: SpreadsheetLogEntry[];
    // (undocumented)
    snapshot?: SpreadsheetSnapshot | undefined;
    // (undocumented)
    snapshotId?: BlobId | undefined;
    // (undocumented)
    startSequenceId: SequenceId;
    // (undocumented)
    tileMap: SpreadsheetTileMap;
}

// Warning: (ae-incompatible-release-tags) The symbol "openSnapshot" is marked as @public, but its signature references "SpreadsheetSnapshot" which is marked as @internal
//
// @public (undocumented)
export function openSnapshot(rootDir: BlobDir<unknown>, snapshotId: BlobId): Promise<Result<SpreadsheetSnapshot, StorageError>>;

// @public
export interface SetCellValueAndFormatLogEntry extends LogEntry, CellData {
    column: number;
    row: number;
    // (undocumented)
    type: 'SetCellValueAndFormat';
}

// Warning: (ae-internal-missing-underscore) The name "SpreadsheetCellMap" should be prefixed with an underscore because the declaration is marked as @internal
//
// @internal (undocumented)
export class SpreadsheetCellMap {
    constructor();
    // (undocumented)
    addEntries(entries: SetCellValueAndFormatLogEntry[], baseIndex: number): void;
    // (undocumented)
    addEntry(row: number, column: number, logIndex: number, value: CellValue, format?: CellFormat): void;
    // (undocumented)
    calcExtents(snapshotIndex: number): CellMapExtents;
    findEntry(row: number, column: number, snapshotIndex: number): CellMapEntry | undefined;
    loadAsSnapshot(src: SpreadsheetCellMap, snapshotIndex: number): void;
    loadSnapshot(snapshot: Uint8Array): void;
    saveSnapshot(snapshotIndex: number): Uint8Array;
}

// @public
export type SpreadsheetLogEntry = SetCellValueAndFormatLogEntry;

// Warning: (ae-internal-missing-underscore) The name "SpreadsheetSnapshot" should be prefixed with an underscore because the declaration is marked as @internal
//
// @internal
export class SpreadsheetSnapshot {
    constructor(id: BlobId, snapshotDir: BlobDir<unknown>, tileDir: BlobDir<unknown>, tileFormat?: TileFormat);
    // (undocumented)
    colCount: number;
    // (undocumented)
    id: BlobId;
    // (undocumented)
    loadIndex(): Promise<Result<void, StorageError>>;
    // (undocumented)
    loadTile(rowMin: number, colMin: number, rowCount: number, colCount: number): Promise<Result<Uint8Array, StorageError>>;
    // (undocumented)
    rowCount: number;
    // (undocumented)
    saveIndex(): Promise<Result<void, StorageError>>;
    // (undocumented)
    saveTile(rowMin: number, colMin: number, rowCount: number, colCount: number, blob: Uint8Array): Promise<Result<void, StorageError>>;
    // (undocumented)
    snapshotDir: BlobDir<unknown>;
    // (undocumented)
    tileDir: BlobDir<unknown>;
    // (undocumented)
    tileFormat: TileFormat | undefined;
}

// Warning: (ae-internal-missing-underscore) The name "SpreadsheetTileMap" should be prefixed with an underscore because the declaration is marked as @internal
//
// @internal
export interface SpreadsheetTileMap {
    findEntry(row: number, column: number): CellMapEntry | undefined;
    loadAsSnapshot(src: SpreadsheetTileMap, changes: SpreadsheetCellMap, snapshotIndex: number): void;
    loadTiles(snapshot: SpreadsheetSnapshot, range?: CellRangeCoords): Promise<Result<void, StorageError>>;
    saveSnapshot(srcSnapshot: SpreadsheetSnapshot | undefined, changes: SpreadsheetCellMap, rowCount: number, colCount: number, destSnapshot: SpreadsheetSnapshot, snapshotIndex: number): Promise<Result<void, StorageError>>;
}

// Warning: (ae-internal-missing-underscore) The name "TileFormat" should be prefixed with an underscore because the declaration is marked as @internal
//
// @internal
export interface TileFormat {
    type: string;
}

// (No @packageDocumentation comment for this package)

```
